# サブエージェント用ツールリファレンス

## 利用可能なツール一覧

### ファイル操作

| ツール | 説明 | 用途 |
|--------|------|------|
| `Read` | ファイル内容を読み取る | コード確認、設定読み込み |
| `Write` | ファイルを作成・上書き | 新規ファイル作成 |
| `Edit` | ファイルを部分編集 | コード修正、設定変更 |
| `Glob` | パターンでファイル検索 | ファイル一覧取得 |
| `Grep` | パターンで内容検索 | コード検索、パターン検出 |

### コマンド実行

| ツール | 説明 | 用途 |
|--------|------|------|
| `Bash` | シェルコマンド実行 | ビルド、テスト、git操作 |

### Web操作

| ツール | 説明 | 用途 |
|--------|------|------|
| `WebFetch` | URLからコンテンツ取得 | ドキュメント参照 |
| `WebSearch` | Web検索 | 情報収集 |

### タスク管理

| ツール | 説明 | 用途 |
|--------|------|------|
| `TodoWrite` | タスクリスト管理 | 進捗追跡 |
| `Task` | サブエージェント呼び出し | タスク委譲 |

### ユーザー対話

| ツール | 説明 | 用途 |
|--------|------|------|
| `AskUserQuestion` | ユーザーに質問 | 確認、選択肢提示 |

---

## ツール組み合わせパターン

### パターン1: 読み取り専用（分析・レビュー用）

```yaml
tools: Read, Grep, Glob
```

**適用エージェント**:
- コードレビュアー
- セキュリティオーディター
- コードアナライザー
- パフォーマンスプロファイラー

**特徴**:
- 変更を加えない
- 安全に実行可能
- 分析に集中

### パターン2: 読み取り + Bash（調査・検証用）

```yaml
tools: Read, Grep, Glob, Bash
```

**適用エージェント**:
- テストランナー（テスト実行のみ）
- ログアナライザー
- 依存関係チェッカー

**特徴**:
- コマンド実行が可能
- テスト実行ができる
- ファイル変更はしない

### パターン3: 編集可能（修正・リファクタリング用）

```yaml
tools: Read, Edit, Grep, Glob
```

**適用エージェント**:
- リファクタラー
- バグフィクサー
- コードフォーマッター

**特徴**:
- 既存ファイルの編集が可能
- 新規ファイル作成はしない
- 制御された変更

### パターン4: フル編集（開発用）

```yaml
tools: Read, Write, Edit, Grep, Glob
```

**適用エージェント**:
- 機能実装者
- ドキュメントライター
- テストジェネレーター

**特徴**:
- ファイルの作成・編集が可能
- 新規コード生成
- ドキュメント作成

### パターン5: フルアクセス（自動化用）

```yaml
tools: Read, Write, Edit, Bash, Grep, Glob
```

**適用エージェント**:
- デバッガー
- デプロイヤー
- 統合テスター

**特徴**:
- すべての操作が可能
- 自動化ワークフロー
- 最大の柔軟性

### パターン6: 全ツール継承

```yaml
# toolsフィールドを省略
```

**適用エージェント**:
- 汎用アシスタント
- プロジェクト固有エージェント

**特徴**:
- メインスレッドの全ツールを継承
- MCPツールも含む
- 最大の互換性

---

## MCPツール

MCPサーバーからのツールも利用可能。

**継承方法**:
- `tools`フィールドを省略すると自動継承
- 個別指定はできない

**確認方法**:
```
/agents
```
で利用可能なツール一覧を確認。

---

## セキュリティ考慮事項

### 最小権限の原則

必要最小限のツールのみを許可：

```yaml
# 悪い例: 過剰な権限
tools: Read, Write, Edit, Bash, Grep, Glob, WebFetch, WebSearch

# 良い例: 必要なツールのみ
tools: Read, Grep, Glob
```

### 危険なツールの制限

| ツール | リスク | 制限推奨 |
|--------|--------|----------|
| `Bash` | 任意コマンド実行 | 信頼できるエージェントのみ |
| `Write` | ファイル上書き | 注意して使用 |
| `Edit` | ファイル変更 | 検証付きで使用 |

### 推奨プラクティス

1. **分析系エージェント**: 読み取り専用ツールのみ
2. **修正系エージェント**: 編集ツールを限定的に
3. **自動化系エージェント**: フルアクセスだが監視付き

---

## ツール選択フローチャート

```
エージェントの目的は？
│
├─ 分析・調査のみ
│  └─ tools: Read, Grep, Glob
│
├─ テスト・検証
│  └─ tools: Read, Grep, Glob, Bash
│
├─ コード修正
│  └─ tools: Read, Edit, Grep, Glob
│
├─ ファイル作成も必要
│  └─ tools: Read, Write, Edit, Grep, Glob
│
├─ 完全な自動化
│  └─ tools: Read, Write, Edit, Bash, Grep, Glob
│
└─ 全機能必要
   └─ toolsフィールドを省略（全継承）
```

---

## トラブルシューティング

### ツールが使えない

1. `tools`フィールドにツール名が正しく記載されているか確認
2. ツール名は大文字小文字を区別
3. カンマ区切りでスペースを入れる

```yaml
# 正しい
tools: Read, Write, Edit

# 間違い
tools: read, write, edit
tools: Read,Write,Edit
```

### MCPツールにアクセスできない

- `tools`フィールドを省略して全ツールを継承
- MCPサーバーが正しく設定されているか確認

### 権限エラー

- サブエージェントに必要なツールが許可されているか確認
- メインスレッドでそのツールが利用可能か確認
